var lasturlrun,comparemode=!1;function loadjson(e,t){for(var s=e.pagespeed.split("\n"),a=new RegExp("(score=[0-9]+)"),i=0,l=0,d=0;d<s.length;d++){var n=s[d];a.test(n)&&(i+=parseInt(n.replace(/.*\(score=([0-9]+)\).*/g,"$1")),l++)}var r=0,o=0,c=atob(e.har),p=JSON.parse(c),v=(new Date(p.log.pages[0].startedDateTime),-1);p.log.entries.forEach(function(e){o+=e.response.bodySize,-1==v&&(v=parseInt(e.timings.wait)),r++});var u=Math.round(i/l),m=0;m=o/1e3>1e3?Math.round(o/1e6).toString()+" MB":Math.round(o/1e3).toString()+" KB";var g=Math.round(parseInt(e.timetoload)/1e3*10)/10,h="";h+="<table>",h+="<tr><td><h2>Summary for "+t+"</h2></td></tr>",h+="<tr><td>",h+="<table>",h+="<tr>",h+='<td rowspan="2">',h+='<div class="blockperf screenshot"><img src="data:image/png;base64,'+e.thumbnail+'" alt=""></div>',h+="</td>",h+="<td>",h+='<div class="blockperf infoblock"><div class="title">Performance grade</div><div class="value">',l>0&&(h+=u>=90?'<span class="lettergood">A</span>':u>=75?'<span class="letteraverage">B</span>':'<span class="letterbad">C</span>'),h+=" "+u.toString()+"</div></div>",h+="</td>",h+="<td>",h+='<div class="blockperf infoblock"><div class="title">Load time</div><div class="value">'+g+" s</div></div>",h+="</td>",h+="<td>",h+='<div class="blockperf infoblock"><div class="title">IPv6</div><div class="value">',e.haveipv6?h+='<span class="lettergood">Yes</span>':h+='<span class="letterbad">No</span>',h+="</div></div>",h+="</td>",h+="</tr>",h+="<tr>",h+="<td>",h+='<div class="blockperf infoblock"><div class="title">Page size</div><div class="value">'+m+"</div></div>",h+="</td>",h+="<td>",h+='<div class="blockperf infoblock"><div class="title">Requests</div><div class="value">'+r.toString()+"</div></div>",h+="</td>",h+="<td>",h+='<div class="blockperf infoblock"><div class="title">First byte</div><div class="value">',h+=v<70?'<span class="lettergood">A</span>':v<140?'<span class="letteraverage">B</span>':'<span class="letterbad">C</span>',h+=" "+v.toString()+" ms</div></div>",h+="</td>",h+="</tr>",h+="</td></tr>";var b=!1;for(d=0;d<s.length;d++){n=s[d];if(a.test(n)){var y=parseInt(n.replace(/.*\(score=([0-9]+)\).*/g,"$1"));if(d<5||y<100){b||(h+="<tr><td><h2>Performance problem</h2></td></tr>",b=!0),h+='<tr><td colspan="4"><button class="accordion"><div style="float:left;width:75px;font-weight:bold;">',h+=y>=90?'<span class="lettergood">A</span>':y>=75?'<span class="letteraverage">B</span>':'<span class="letterbad">C</span>',h+=" "+y.toString()+"</div>",h+=n.replace(/.*_([^_]+)_.*/g,"$1")+'</button><div class="panel">';for(var f=!1,B=d+1;B<s.length;B++){var I=s[B];if(a.test(I))break;if(I.startsWith("    * ")?0==f&&(h+="<ul>",f=!0):1==f&&(h+="</ul>",f=!1),I.startsWith("http://")||I.startsWith("https://")||I.startsWith("    * http://")||I.startsWith("    * https://")){var k=I.startsWith("    * ");k&&(h+="<li>"),h+='<a href="'+(I=I.replace("    * ",""))+'">'+I.trunc(50)+"</a><br />",k&&(h+="</li>")}else h+=I+"<br />"}h+="</div></td></tr>"}}}h+="</table><br />",comparemode?comparemode=!1:h+='<div id="HarViewer"></div>',document.getElementById("step3").innerHTML=h;var w=document.getElementsByClassName("accordion");for(d=0;d<w.length;d++)w[d].onclick=function(){this.classList.toggle("active");var e=this.nextElementSibling;"block"===e.style.display?e.style.display="none":e.style.display="block"}}function step1(){if("none"!=document.getElementById("step1").style.display){var e=document.getElementById("url").value;if(""==e)return;document.getElementById("step1").style.display="none",document.getElementById("step2").style.display="block",document.getElementById("step3").style.display="none",document.getElementById("step4").style.display="none",e.startsWith("http://")||e.startsWith("https://")||(e="http://"+e),comparemode||(document.getElementById("trd").innerHTML='<div id="step4"></div>'),document.getElementById("step2").innerHTML="<h1>Analyse in progress...</h1><h3>"+e+'</h3><div id="cooking"><div class="bubble"></div><div class="bubble"></div><div class="bubble"></div><div class="bubble"></div><div class="bubble"></div><div id="area"><div id="sides"><div id="pan"></div><div id="handle"></div></div><div id="pancake"><div id="pastry"></div></div></div></div>';var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4==this.readyState)if(document.getElementById("step1").style.display="block",document.getElementById("step2").style.display="none",document.getElementById("step3").style.display="block",document.getElementById("step4").style.display="block",200==this.status){lasturlrun=e;var t=JSON.parse(this.responseText);if(e.includes(".optimize.confiared.com")?document.getElementById("Compare").style.display="none":document.getElementById("Compare").style.display="block","saveid"in t)if(null!==window.location.href.match("^[a-z]+://[^/]+/save/[a-f0-9]{8}$")&&comparemode){var s=window.location.href.replace(/^[a-z]+:\/\/[^/]+\/save\/([a-z0-9]{8})/g,"$1");window.location.href="/save/"+s+"/"+t.saveid}else window.location.href="/save/"+t.saveid;else if(loadjson(t,e),!comparemode){harviewer=new HarViewer("HarViewer");var a=atob(t.har),i=JSON.parse(a);harviewer.loadHar(i)}}else document.getElementById("step3").innerHTML="<br /><br /><h3>Bug, contact the admin</h3><br /><br />"},t.open("POST","/benchmark.php",!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send("url="+e)}}function compare(){if(""!=lasturlrun){var e=document.getElementById("HarViewer");if(e.outerHTML="",delete e,document.getElementById("trd").innerHTML=document.getElementById("tro").innerHTML.replace('div id="step3"','div id="step4"'),(lasturlrun.match(/\//g)||[]).length<3)lasturlrun+=".optimize.confiared.com";else{var t=lasturlrun.indexOf("/",8);-1==t?lasturlrun+=".optimize.confiared.com":lasturlrun=lasturlrun.slice(0,t)+".optimize.confiared.com"+lasturlrun.slice(t)}document.getElementById("Compare").style.display="none",document.getElementById("url").value=lasturlrun,comparemode=!0,step1()}}String.prototype.trunc=String.prototype.trunc||function(e){return this.length>e?this.substr(0,e-1)+"&hellip;":this};